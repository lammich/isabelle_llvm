<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹~~/src/Provers/order_procedure.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹~~/src/Provers/order_procedure.ML›</h1>
</div>

<pre class="source"><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Order_Procedure</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Int_of_integer</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> int
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> integer_of_int </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span>
  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> 'a </span><span class="entity"><span>fm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm * 'a fm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm * 'a fm </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>Neg</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm
  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>trm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Const</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta
  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>prf_trm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Appt</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> prf_trm * trm </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>AppP</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> prf_trm * prf_trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>AbsP</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * prf_trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Bound</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>Conv</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * prf_trm * prf_trm
  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>order_atom</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta </span><span class="main"><span>|</span></span><span>
    </span><span class="entity"><span>LESS</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> lo_contr_prf </span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>bool</span><span> * </span><span class="entity"><span>order_atom</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>fm</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>prf_trm</span></span><span> </span><span>option</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> po_contr_prf </span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>bool</span><span> * </span><span class="entity"><span>order_atom</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>fm</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>prf_trm</span></span><span> </span><span>option</span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Int_of_integer</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> int</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Int_of_integer</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>equal_inta</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> 'a </span><span class="entity"><span>equal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>equal </span><span class="main"><span>:</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equal</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>equal </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>equal</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equal_int</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>equal </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>equal_inta</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="entity"><span>equal</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>less_eq_int</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span>&lt;=</span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> 'a </span><span class="entity"><span>ord</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>less_eq </span><span class="main"><span>:</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>,</span></span><span> less </span><span class="main"><span>:</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>less_eq</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>less_eq </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>ord</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>less </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>ord</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>less_int</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span>&lt;</span><span> </span><span class="entity"><span>integer_of_int</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ord_int</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>less_eq </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>less_eq_int</span></span><span class="main"><span>,</span></span><span> less </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>less_int</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="entity"><span>ord</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> 'a </span><span class="entity"><span>preorder</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>ord_preorder </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>ord</span></span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ord_preorder</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>ord_preorder </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>preorder</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="entity"><span>ord</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> 'a </span><span class="entity"><span>order</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>preorder_order </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>preorder</span></span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>preorder_order</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>preorder_order </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>order</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="entity"><span>preorder</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>preorder_int</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>ord_preorder </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ord_int</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="entity"><span>preorder</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>order_int</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>preorder_order </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>preorder_int</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="entity"><span>order</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> 'a </span><span class="entity"><span>linorder</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>order_linorder </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>order</span></span><span class="main"><span>}</span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>order_linorder</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>#</span></span><span>order_linorder </span><span class="main"><span>:</span></span><span> 'a </span><span class="entity"><span>linorder</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="entity"><span>order</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>linorder_int</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>order_linorder </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>order_int</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>inta</span></span><span> </span><span class="entity"><span>linorder</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>equal</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>equal_proda</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>y1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x1</span></span><span> </span><span class="entity"><span>y1</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="entity"><span>x2</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>equal_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>equal </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>equal_proda</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>'a * 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>equal</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>less_eq_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x1</span></span><span> </span><span class="entity"><span>x2</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>less_eq</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x1</span></span><span> </span><span class="entity"><span>x2</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>less_eq</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="entity"><span>y1</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>less_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x1</span></span><span> </span><span class="entity"><span>x2</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>less_eq</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x1</span></span><span> </span><span class="entity"><span>x2</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="entity"><span>y1</span></span><span> </span><span class="entity"><span>y2</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ord_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>less_eq </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>less_eq_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>,</span></span><span> less </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>less_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span>
  </span><span class="main"><span>(</span></span><span>'a * 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ord</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>preorder_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>{</span></span><span>ord_preorder </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ord_prod</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ord_preorder</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ord_preorder</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span>
  </span><span class="main"><span>(</span></span><span>'a * 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>preorder</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>order_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>{</span></span><span>preorder_order </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>preorder_prod</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>preorder_order</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>preorder_order</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span>
  </span><span class="main"><span>(</span></span><span>'a * 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>order</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>{</span></span><span>order_linorder </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>order_prod</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>order_linorder</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>order_linorder</span></span><span> </span><span class="entity"><span>B_</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>:</span></span><span>
  </span><span class="main"><span>(</span></span><span>'a * 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>linorder</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>nat</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Suc</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> nat</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>color</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>R</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>B</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="main"><span>(</span></span><span>'a</span><span class="main"><span>,</span></span><span> 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rbta</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Branch</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> color * </span><span class="main"><span>(</span></span><span>'a</span><span class="main"><span>,</span></span><span> 'b</span><span class="main"><span>)</span></span><span> rbta * 'a * 'b * </span><span class="main"><span>(</span></span><span>'a</span><span class="main"><span>,</span></span><span> 'b</span><span class="main"><span>)</span></span><span> rbta</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="main"><span>(</span></span><span>'b</span><span class="main"><span>,</span></span><span> 'a</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rbt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>RBT</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span class="main"><span>(</span></span><span>'b</span><span class="main"><span>,</span></span><span> 'a</span><span class="main"><span>)</span></span><span> rbta</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> 'a </span><span class="entity"><span>set</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Set</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a list </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Coset</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a list</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> 'a </span><span class="entity"><span>fm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm * 'a fm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm * 'a fm </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Neg</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> 'a fm</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>trm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Const</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>prf_trm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Appt</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> prf_trm * trm </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>AppP</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> prf_trm * prf_trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>AbsP</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * prf_trm </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Bound</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Conv</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> trm * prf_trm * prf_trm</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="main"><span>(</span></span><span>'a</span><span class="main"><span>,</span></span><span> 'b</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>mapping</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Mapping</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span class="main"><span>(</span></span><span>'a</span><span class="main"><span>,</span></span><span> 'b</span><span class="main"><span>)</span></span><span> rbt</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>order_atom</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>LESS</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> inta * inta</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>id</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>xa</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>xa</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>impl_of</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>RBT</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>foldb</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lt</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>foldb</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>rt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>foldb</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>lt</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>foldb</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>fold</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>xc</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>foldb</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>impl_of</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xc</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="entity"><span>kts</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>kts</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>l</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>kts</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="entity"><span>kts</span></span><span> </span><span class="entity"><span>t</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>keysb</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>gen_keys</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>keys</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>keysb</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>impl_of</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>maps</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>maps</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>maps</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>empty</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>RBT</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>foldl</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>a</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>foldl</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>foldl</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>foldr</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>id</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>foldr</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>foldr</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span>
    </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>z</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>w</span></span><span> </span><span class="entity"><span>x</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>w</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
          </span><span class="entity"><span>Branch</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vn</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vo</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vp</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
          </span><span class="entity"><span>Branch</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vn</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vo</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vp</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vh</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ve</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>balance</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vn</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vo</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vp</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>s</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Branch</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span>
            </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vj</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vk</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vl</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vm</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vn</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vo</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vp</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vd</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Empty</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>r</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>balance</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span>
             </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span>
             </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>R</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>paint</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Empty</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>paint</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>uu</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rbt_insert_with_key</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>paint</span></span><span> </span><span class="entity"><span>B</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rbt_ins</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rbt_insert</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>rbt_insert_with_key</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>nv</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>nv</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>insert</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xc</span></span><span> </span><span class="entity"><span>xd</span></span><span> </span><span class="entity"><span>xe</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>RBT</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rbt_insert</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>ord_preorder</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>preorder_order</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>order_linorder</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xc</span></span><span> </span><span class="entity"><span>xd</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>impl_of</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xe</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rbt_lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>Empty</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>rbt_lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Branch</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>uu</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>rbt_lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="entity"><span>k</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>less</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>rbt_lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>r</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>rbt_lookup</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>ord_preorder</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>preorder_order</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>order_linorder</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>impl_of</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>member</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>false</span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>member</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="keyword1"><span class="keyword"><span>orelse</span></span></span><span> </span><span class="entity"><span>member</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>remdups</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>remdups</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>member</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>remdups</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>remdups</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>psi</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="entity"><span>phi_1</span></span><span> </span><span class="entity"><span>psi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="entity"><span>phi_2</span></span><span> </span><span class="entity"><span>psi</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>dnf_and_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>folda</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Mapping</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>fold</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>keysa</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Mapping</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Set</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>keys</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>a</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Neg</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>h</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>emptya</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>empty</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lookupa</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Mapping</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lookup</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>update</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Mapping</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>insert</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>gen_length</span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>gen_length</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Suc</span></span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xs</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>gen_length</span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>size_list</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>gen_length</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>card</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Set</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>size_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>remdups</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>conj_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>conj_list</span></span><span> </span><span class="entity"><span>phi_1</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>conj_list</span></span><span> </span><span class="entity"><span>phi_2</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>conj_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>a</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"conj"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"disj"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"Not"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>psi</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"then_conv"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>[</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"conj_disj_distribR_conv"</span></span><span class="main"><span>,</span></span><span>
      </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="entity"><span>phi_1</span></span><span> </span><span class="entity"><span>psi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
          </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="entity"><span>phi_2</span></span><span> </span><span class="entity"><span>psi</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"then_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"conj_disj_distribL_conv"</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"then_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"conj_disj_distribL_conv"</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"then_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"conj_disj_distribL_conv"</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>va</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"then_conv"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>[</span></span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span>
      </span><span class="entity"><span>dnf_and_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>of_alist</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>foldr</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>update</span></span><span> </span><span class="entity"><span>A_</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>emptya</span></span><span> </span><span class="entity"><span>A_</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>map_option</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>map_option</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>from_conj_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>aa</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ba</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>aa</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ba</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"conjE"</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>[</span></span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
      </span><span class="entity"><span>AbsP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span>
             </span><span class="entity"><span>AbsP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>,</span></span><span>
                    </span><span class="entity"><span>from_conj_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>from_conj_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>p</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span>
                      </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>from_conj_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>p</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="entity"><span>c</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
    </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>p1</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>map_option</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>p2</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"disjE"</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>[</span></span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>AbsP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>c</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>p1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>AbsP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>p2</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="entity"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>conj_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>p</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>from_conj_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>p</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_atom</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>contr_atom_prf</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>a</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>fst</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>x1</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>snd</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>x2</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"less_le"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"nless_le"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"nle_le"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>one_nat</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>nat</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Suc</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"less_le"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"nless_le"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"all_conv"</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>minus_nat</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Suc</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Suc</span></span><span> </span><span class="entity"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>minus_nat</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="entity"><span>n</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>minus_nat</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span> </span><span class="entity"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>minus_nat</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>relcomp1_mapping</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>C1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>C2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y1</span></span><span> </span><span class="entity"><span>pxy</span></span><span> </span><span class="entity"><span>pm</span></span><span> </span><span class="entity"><span>pma</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>folda</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>C2_</span></span><span> </span><span class="entity"><span>C2_</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>y2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pyz</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pmb</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>C1_</span></span><span> </span><span class="entity"><span>y1</span></span><span> </span><span class="entity"><span>y2</span></span><span> </span><span class="keyword1"><span class="keyword"><span>andalso</span></span></span><span> </span><span>not</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>C1_</span></span><span> </span><span class="entity"><span>y2</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>update</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>B_</span></span><span> </span><span class="entity"><span>C2_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>pxy</span></span><span> </span><span class="entity"><span>pyz</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>pmb</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>pmb</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>pm</span></span><span> </span><span class="entity"><span>pma</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>relcomp_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>pm1</span></span><span> </span><span class="entity"><span>pm2</span></span><span> </span><span class="entity"><span>pma</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>folda</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>B2_</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pxy</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>pm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>eq</span></span><span> </span><span class="entity"><span>B1_</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>pm</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>relcomp1_mapping</span></span><span> </span><span class="entity"><span>B2_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="entity"><span>y</span></span><span> </span><span class="entity"><span>pxy</span></span><span> </span><span class="entity"><span>pm2</span></span><span> </span><span class="entity"><span>pm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>pm1</span></span><span> </span><span class="entity"><span>pma</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ntrancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>Zero_nat</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>m</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ntrancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Suc</span></span><span> </span><span class="entity"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trclm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ntrancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>k</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>relcomp_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>trclm</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="entity"><span>trclm</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span> </span><span class="entity"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>ntrancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>B1_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>combine</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>minus_nat</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>card</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>equal_prod</span></span><span> </span><span class="entity"><span>B1_</span></span><span> </span><span class="entity"><span>B1_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>keysa</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>B2_</span></span><span> </span><span class="entity"><span>B2_</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="entity"><span>one_nat</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>m</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trm_of_order_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"eq"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_order_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"le"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_order_atom</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"lt"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>trm_of_order_atom</span></span><span> </span><span class="entity"><span>a</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>App</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Const</span></span><span> </span><span class="inner_quoted"><span>"Not"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>trm_of_order_atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_in_leq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>equal_inta</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>fst</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>snd</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Appt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"refl"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Var</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>fst</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>lookupa</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>linorder_int</span></span><span> </span><span class="entity"><span>linorder_int</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_in_eq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>is_in_leq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>is_in_leq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>snd</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>fst</span></span><span> </span><span class="entity"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span class="main"><span>(</span></span><span>NONE</span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>p1</span></span><span class="main"><span>,</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>p2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"antisym"</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>p1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>p2</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>contr1_list</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>map_option</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"contr"</span></span><span class="main"><span>,</span></span><span>
                   </span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
             </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>is_in_leq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr1_list</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>map_option</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"contr"</span></span><span class="main"><span>,</span></span><span>
                     </span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
               </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>is_in_eq</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr1_list</span></span><span> </span><span class="entity"><span>uu</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr1_list</span></span><span> </span><span class="entity"><span>uu</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>contr_list_aux</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>contr_list_aux</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>l</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>ls</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>contr1_list</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>l</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>contr_list_aux</span></span><span> </span><span class="entity"><span>leqm</span></span><span> </span><span class="entity"><span>ls</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>leq1_member_list</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LEQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>leq1_member_list</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
       </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"eqD1"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
        </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"eqD2"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Bound</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span>true</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>EQ</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>leq1_member_list</span></span><span> </span><span class="main"><span>(</span></span><span>false</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>leq1_member_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>LESS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>vb</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>vc</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>leq1_list</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>maps</span></span><span> </span><span class="entity"><span>leq1_member_list</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>leq1_mapping</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>of_alist</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>linorder_prod</span></span><span> </span><span class="entity"><span>linorder_int</span></span><span> </span><span class="entity"><span>linorder_int</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>leq1_list</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>contr_list</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>contr_list_aux</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>trancl_mapping</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>equal_int</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>linorder_int</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>p1</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>p2</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>aa</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>aa</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"trans"</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>p1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>p2</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>leq1_mapping</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="entity"><span>a</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>contr_prf</span></span><span> </span><span class="entity"><span>atom_conv</span></span><span> </span><span class="entity"><span>phi</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>contr_fm_prf</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="entity"><span>contr_list</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dnf_fm</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>atom_conv</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Atom</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"atom_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>phi_1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>foldl</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"combination_conv"</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>[</span></span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>phi_1</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>phi_2</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Neg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>AppP</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>PThm</span></span><span> </span><span class="inner_quoted"><span>"arg_conv"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>ap</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lo_contr_prf</span></span><span> </span><span class="entity"><span>phi</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>map_option</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
       </span><span class="entity"><span>Conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>deneg_prf</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>o</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
               </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>contr_prf</span></span><span> </span><span class="entity"><span>deneg</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>po_contr_prf</span></span><span> </span><span class="entity"><span>phi</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>map_option</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
       </span><span class="entity"><span>Conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>amap_f_m_prf</span></span><span> </span><span class="entity"><span>deless_prf</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>,</span></span><span>
              </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>o</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Conv</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>trm_of_fm</span></span><span> </span><span class="entity"><span>trm_of_order_literal</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
               </span><span class="entity"><span>dnf_fm_prf</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>amap_fm</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>contr_prf</span></span><span> </span><span class="entity"><span>deless</span></span><span> </span><span class="entity"><span>phi</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span> </span><span class="comment1"><span>(*struct Order_Procedure*)</span></span><span>

</span></pre>
</body>

</html>