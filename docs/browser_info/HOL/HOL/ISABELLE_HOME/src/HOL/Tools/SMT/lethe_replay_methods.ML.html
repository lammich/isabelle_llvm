<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹Tools/SMT/lethe_replay_methods.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹Tools/SMT/lethe_replay_methods.ML›</h1>
</div>

<pre class="source"><span class="comment1"><span>(*  Title:      HOL/Tools/SMT/lethe_replay_methods.ML
    Author:     Mathias Fleury, MPII, JKU, University Freiburg

Proof method for replaying veriT proofs.
*)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>signature</span></span></span><span> </span><span class="entity"><span>LETHE_REPLAY_METHODS</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>sig</span></span></span><span>


  </span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>verit_rule</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="entity"><span>False</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>True</span></span><span> </span><span class="main"><span>|</span></span><span>

     </span><span class="comment1"><span>(*input: a repeated (normalized) assumption of  assumption of in a subproof*)</span></span><span>
     </span><span class="entity"><span>Normalized_Input</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Local_Input</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Subproof:*)</span></span><span>
     </span><span class="entity"><span>Subproof</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Conjunction:*)</span></span><span>
     </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_And</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Neg</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Disjunction""*)</span></span><span>
     </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Or</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Neg</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Disjunction:*)</span></span><span>
     </span><span class="entity"><span>Implies</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Implies1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Implies2</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Equivalence:*)</span></span><span>
     </span><span class="entity"><span>Equiv_neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_pos1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_pos2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Equiv1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Equiv2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv2</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*If-then-else:*)</span></span><span>
     </span><span class="entity"><span>ITE_Pos1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Pos2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_ITE1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_ITE2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Intro</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE2</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Equality:*)</span></span><span>
     </span><span class="entity"><span>Eq_Congruent</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Reflexive</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Transitive</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Congruent_Pred</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Trans</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>Refl</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>Cong</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Arithmetics:*)</span></span><span>
     </span><span class="entity"><span>LA_Disequality</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Tautology</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>LIA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Totality</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_RW_Eq</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>NLA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Quantifiers:*)</span></span><span>
     </span><span class="entity"><span>Forall_Inst</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Qnt_Rm_Unused</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Qnt_Join</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Onepoint</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Bind</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Skolem_Forall</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Skolem_Ex</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Resolution:*)</span></span><span>
     </span><span class="entity"><span>Theory_Resolution</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Resolution</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Temporary rules, that the verit developers want to remove:*)</span></span><span>
     </span><span class="entity"><span>AC_Simp</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Bfun_Elim</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Qnt_CNF</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Used to introduce skolem constants*)</span></span><span>
     </span><span class="entity"><span>Definition</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Former cong rules*)</span></span><span>
     </span><span class="entity"><span>Bool_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Implies_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Connective_Def</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Minus_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Comp_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Eq_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Sum_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Prod_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>All_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Qnt_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Not</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Tautological_Clause</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Duplicate_Literals</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Unsupported rule*)</span></span><span>
     </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*For compression*)</span></span><span>
     </span><span class="entity"><span>Theory_Resolution2</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*Extended rules*)</span></span><span>
     </span><span class="entity"><span>Symm</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Symm</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Reordering</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Tmp_Quantifier_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
     </span><span class="comment1"><span>(*CVC5 to support new rules declared later (like BV rules)*)</span></span><span>
     </span><span class="entity"><span>Other_Rule</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span>
     </span><span class="entity"><span>Hole</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> requires_subproof_assms </span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> requires_local_input</span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>bool</span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> string_of_verit_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>verit_rule</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>string</span><span>

  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>
  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>
  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>Symtab.table</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> bind</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> and_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> and_neg_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> and_pos</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_and_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_bool_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_comp_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_minus_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_not_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_eq_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_equiv_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_implies_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_or_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> cong</span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_connective_def</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> duplicate_literals</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> eq_congruent</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> eq_congruent_pred</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> eq_reflexive</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> eq_transitive</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv_neg1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv_neg2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv_pos1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> equiv_pos2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> false_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> forall_inst</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac2</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> implies_rules</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> implies_neg1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> implies_neg2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> implies_pos</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite_intro</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite_neg1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite_neg2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite_pos1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> ite_pos2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rewrite_ite_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> la_disequality</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> la_generic</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> la_rw_eq</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> lia_generic</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> refl</span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> normalized_input</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_and_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_equiv1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_equiv2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_implies1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_implies2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_ite1</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_ite2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_not</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_or_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> or</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> or_neg_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> or_pos_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> theory_resolution2</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> prod_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> qnt_join</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> qnt_rm_unused</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> onepoint</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> qnt_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> all_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> unit_res</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> skolem_ex</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> skolem_forall</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> subproof</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> sum_simplify</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> tautological_clause</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> tmp_AC_rule</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> bfun_elim</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> qnt_cnf</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> trans</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> symm</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> not_symm</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> reordering</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span>


  </span><span class="comment1"><span>(*Extension to declare new alethe rules*)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> declare_alethe_rule</span><span class="main"><span>:</span></span><span>  </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> rm_alethe_rule</span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> get_alethe_tac</span><span class="main"><span>:</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span> </span><span>option</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> print_alethe_tac</span><span class="main"><span>:</span></span><span> </span><span>Context.generic</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>Pretty.T</span><span>

  </span><span class="comment1"><span>(*Useful lifting of tactics*)</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> REPEAT_CHANGED</span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>tactic</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>tactic</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> TRY'</span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>tactic</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a </span><span class="main"><span>-&gt;</span></span><span> </span><span>tactic</span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> simplify_tac</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>int</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>tactic</span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> replay_error</span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>string</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span class="entity"><span>verit_rule</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> 'a

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Lethe_Replay_Methods</span></span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>LETHE_REPLAY_METHODS</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac_args</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>
</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>
</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>lethe_tac2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Proof.context</span></span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>list</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span>Symtab.table</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>term</span><span> </span><span class="main"><span>-&gt;</span></span><span> </span><span>thm</span><span>

</span><span class="comment1"><span>(*Some general comments on the proof format:
  1. Double negations are not always removed. This means for example that the equivalence rules
     cannot assume that the double negations have already been removed. Therefore, we match the
     term, instantiate the theorem, then use simp (to remove double negations), and finally use
     assumption.
  2. The reconstruction for rule forall_inst is buggy and tends to be very fragile, because the rule
     is doing much more that is supposed to do. Moreover types can make trivial goals (for the
     boolean structure) impossible to prove.
  3. Duplicate literals are sometimes removed, mostly by the SAT solver.

  Rules unsupported on purpose:
    * Distinct_Elim, XOR, let (we don't need them).
    * deep_skolemize (because it is not clear if verit still generates using it).
*)</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span class="entity"><span>verit_rule</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span class="entity"><span>False</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>True</span></span><span> </span><span class="main"><span>|</span></span><span>

   </span><span class="comment1"><span>(*input: a repeated (normalized) assumption of  assumption of in a subproof*)</span></span><span>
   </span><span class="entity"><span>Normalized_Input</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Local_Input</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Subproof:*)</span></span><span>
   </span><span class="entity"><span>Subproof</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Conjunction:*)</span></span><span>
   </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_And</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Neg</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Disjunction""*)</span></span><span>
   </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Or</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Neg</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Disjunction:*)</span></span><span>
   </span><span class="entity"><span>Implies</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Implies_Pos</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Implies1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Implies2</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Equivalence:*)</span></span><span>
   </span><span class="entity"><span>Equiv_neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_pos1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_pos2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Equiv1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Equiv2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv2</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*If-then-else:*)</span></span><span>
   </span><span class="entity"><span>ITE_Pos1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Pos2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Neg1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Neg2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_ITE1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_ITE2</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Intro</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE1</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE2</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Equality:*)</span></span><span>
   </span><span class="entity"><span>Eq_Congruent</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Reflexive</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Transitive</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Eq_Congruent_Pred</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Trans</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>Refl</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>Cong</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Arithmetics:*)</span></span><span>
   </span><span class="entity"><span>LA_Disequality</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Tautology</span></span><span> </span><span class="main"><span>|</span></span><span>  </span><span class="entity"><span>LIA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_Totality</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>LA_RW_Eq</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>NLA_Generic</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Quantifiers:*)</span></span><span>
   </span><span class="entity"><span>Forall_Inst</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Qnt_Rm_Unused</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Qnt_Join</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Onepoint</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Bind</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Skolem_Forall</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Skolem_Ex</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Resolution:*)</span></span><span>
   </span><span class="entity"><span>Theory_Resolution</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Resolution</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Temporary rules, that the verit developpers want to remove:*)</span></span><span>
   </span><span class="entity"><span>AC_Simp</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Bfun_Elim</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Qnt_CNF</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Used to introduce skolem constants*)</span></span><span>
   </span><span class="entity"><span>Definition</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Former cong rules*)</span></span><span>
   </span><span class="entity"><span>Bool_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Or_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>And_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Equiv_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Implies_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Connective_Def</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Minus_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Comp_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Eq_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>ITE_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Sum_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Prod_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>All_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Qnt_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Not</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Tautological_Clause</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Duplicate_Literals</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Unsupported rule*)</span></span><span>
   </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*For compression*)</span></span><span>
   </span><span class="entity"><span>Theory_Resolution2</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*Extended rules*)</span></span><span>
   </span><span class="entity"><span>Symm</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Not_Symm</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Reordering</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>Tmp_Quantifier_Simplify</span></span><span> </span><span class="main"><span>|</span></span><span>
   </span><span class="comment1"><span>(*CVC5*)</span></span><span>
   </span><span class="entity"><span>Other_Rule</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> string </span><span class="main"><span>|</span></span><span>
   </span><span class="entity"><span>Hole</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Bind</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Bind"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Cong</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Cong"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Refl</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Refl"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv_pos1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv_pos1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv_pos2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv_pos2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv_neg1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv_neg1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv_neg2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Equiv_neg2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Skolem_Forall</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Skolem_Forall"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Skolem_Ex</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Skolem_Ex"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Eq_Reflexive</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Eq_Reflexive"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Theory_Resolution</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Theory_Resolution"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Theory_Resolution2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Theory_Resolution2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Forall_Inst</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"forall_inst"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Or"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Or</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Not_Or"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Resolution</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Resolution"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Eq_Congruent</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"eq_congruent"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Trans</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"trans"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>False</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"false"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>And</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"and"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>And_Pos</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"and_pos"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_And</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_and"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>And_Neg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"and_neg"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Or_Pos</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"or_pos"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Or_Neg</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"or_neg"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>AC_Simp</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ac_simp"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Equiv1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_equiv1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Equiv2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_equiv2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Implies1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_implies1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Implies2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_implies2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Implies_Neg1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"implies_neg1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Implies_Neg2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"implies_neg2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Implies</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"implies"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Bfun_Elim</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"bfun_elim"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_ITE1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_ite1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_ITE2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_ite2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Pos1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_pos1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Pos2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_pos2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Neg1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_neg1"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Neg2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_neg2"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Intro</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_intro"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LA_Disequality</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"la_disequality"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LA_Generic</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"la_generic"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LIA_Generic</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"lia_generic"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LA_Tautology</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"la_tautology"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LA_RW_Eq</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"la_rw_eq"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>LA_Totality</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"LA_Totality"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>NLA_Generic</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"nla_generic"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Eq_Transitive</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"eq_transitive"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Qnt_Rm_Unused</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"qnt_remove_unused"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Onepoint</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"onepoint"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Qnt_Join</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"qnt_join"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Eq_Congruent_Pred</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"eq_congruent_pred"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Normalized_Input</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Lethe_Proof.normalized_input_rule</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Local_Input</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Lethe_Proof.local_input_rule</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Subproof</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"subproof"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Bool_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"bool_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Equiv_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"equiv_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Eq_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"eq_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>And_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"and_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Or_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"or_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>ITE_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"ite_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Implies_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"implies_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Connective_Def</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"connective_def"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Minus_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"minus_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Sum_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"sum_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Prod_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"prod_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>All_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"all_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Comp_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"comp_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Qnt_Simplify</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"qnt_simplify"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Symm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"symm"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Symm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"not_symm"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Reordering</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"reordering"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Not_Not</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Lethe_Proof.not_not_rule</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Tautological_Clause</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"tautology"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Duplicate_Literals</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Lethe_Proof.contract_rule</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Qnt_CNF</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"qnt_cnf"</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Other_Rule</span></span><span> </span><span class="entity"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>r</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="inner_quoted"><span>"Unknown rule: "</span></span><span> </span><span>^</span><span> </span><span class="antiquoted"><span class="operator"><span class="entity"><span class="entity"><span><span class="hidden">\&lt;^</span><span class="control">make_string</span><span class="hidden">&gt;</span></span></span></span></span></span><span> </span><span class="entity"><span>r</span></span><span>

</span><span class="comment1"><span>(** Context Extension for Rules **)</span></span><span>
</span><span class="comment1"><span>(*We currently do not distinguish between the extension required for each solver. Maybe later
it will be needed.*)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>alethe_rule_ext</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>rules</span><span class="main"><span>:</span></span><span> </span><span class="main"><span>(</span></span><span>string</span><span> * </span><span class="entity"><span>lethe_tac_args</span></span><span class="main"><span>)</span></span><span> </span><span>list</span><span class="main"><span>}</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>mk_alethe_rule_ext</span></span><span> </span><span class="entity"><span>rules</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>alethe_rule_ext</span></span><span> </span><span class="main"><span>=</span></span><span> 
   </span><span class="main"><span>{</span></span><span>rules</span><span class="main"><span>=</span></span><span class="entity"><span>rules</span></span><span class="main"><span>}</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>empty_data</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>mk_alethe_rule_ext</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>merge_data</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span>rules</span><span class="main"><span>=</span></span><span class="entity"><span>rules1</span></span><span class="main"><span>}</span></span><span class="main"><span>:</span></span><span class="entity"><span>alethe_rule_ext</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>{</span></span><span>rules</span><span class="main"><span>=</span></span><span class="entity"><span>rules2</span></span><span class="main"><span>}</span></span><span class="main"><span>:</span></span><span class="entity"><span>alethe_rule_ext</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>alethe_rule_ext</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>mk_alethe_rule_ext</span></span><span> </span><span class="main"><span>(</span></span><span>AList.merge</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>true</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rules1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rules2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Data</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Generic_Data</span><span>
</span><span class="main"><span>(</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>alethe_rule_ext</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>empty</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>empty_data</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>merge</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>merge_data</span></span><span>
</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>declare_alethe_rule</span></span><span> </span><span class="entity"><span>rule</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>rules</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Data.get</span><span> </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span>Data.map</span><span>
      </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mk_alethe_rule_ext</span></span><span> </span><span class="main"><span>(</span></span><span>AList.update</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rule</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>tac</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rules</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rm_alethe_rule</span></span><span> </span><span class="entity"><span>stgy</span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>rules</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Data.get</span><span> </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span>Data.map</span><span>
      </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>mk_alethe_rule_ext</span></span><span> </span><span class="main"><span>(</span></span><span>AList.delete</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>stgy</span></span><span> </span><span class="entity"><span>rules</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get_alethe_tac</span></span><span> </span><span class="entity"><span>rule</span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>rules</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Data.get</span><span> </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rules</span></span><span> </span><span class="entity"><span>rule</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print_alethe_tac</span></span><span> </span><span class="entity"><span>context</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>{</span></span><span class="entity"><span>rules</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Data.get</span><span> </span><span class="entity"><span>context</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>rules</span></span><span>
    </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>"-&gt;"</span></span><span> </span><span>^</span><span> </span><span class="antiquoted"><span class="entity"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>make_string</span></span><span class="antiquote"><span>}</span></span></span></span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span>
    </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span>Pretty.str</span><span>
    </span><span>|&gt;</span><span> </span><span>Pretty.big_list</span><span> </span><span class="inner_quoted"><span>"Declared alethe rules:\n"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(** Tactics for Reconstruction **)</span></span><span>
</span><span class="comment1"><span>(**)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="entity"><span>rule</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>msg</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>rule</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>

</span><span class="comment1"><span>(* utility function *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eqsubst_all</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>REPEAT</span><span> </span><span>o</span><span> </span><span>HEADGOAL</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>EqSubst.eqsubst_asm_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_numeral"><span>0</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
   </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>REPEAT</span><span> </span><span>o</span><span> </span><span>HEADGOAL</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>EqSubst.eqsubst_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_numeral"><span>0</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>ctxt</span></span><span>
  </span><span>|&gt;</span><span> </span><span>empty_simpset</span><span>
  </span><span>|&gt;</span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span>
  </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>addsimps</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.simp_thms|fact"><span>simp_thms</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>addsimps</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
  </span><span>|&gt;</span><span> </span><span class="entity"><span>Simplifier.asm_full_simp_tac</span></span><span>

</span><span class="comment1"><span>(* sko_forall requires the assumptions to be able to prove the equivalence in case of double
skolemization. See comment below. *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>requires_subproof_assms</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>member</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_quoted"><span>"refl"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"sko_forall"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"sko_ex"</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_quoted"><span>"cong"</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>requires_local_input</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>member</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>Lethe_Proof.local_input_rule</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span>

</span><span class="comment1"><span>(*This is a weaker simplification form. It is weaker, but is also less likely to loop*)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>ctxt</span></span><span>
  </span><span>|&gt;</span><span> </span><span>empty_simpset</span><span>
  </span><span>|&gt;</span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span>
  </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>addsimps</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.simp_thms|fact"><span>simp_thms</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>addsimps</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
  </span><span>|&gt;</span><span> </span><span class="entity"><span>Simplifier.full_simp_tac</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>try_provers</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.try_provers</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>TRY</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>REPEAT</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>REPEAT_CHANGED</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>REPEAT</span><span> </span><span class="main"><span>(</span></span><span>CHANGED</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>


</span><span class="comment1"><span>(* Bind *)</span></span><span>

</span><span class="comment1"><span>(*The bind rule is non-obvious due to the handling of quantifiers:
  "⋀x y a. x = y ==&gt; (∀b. P a b x) ⟷ (∀b. P' a b y)"
  ------------------------------------------------------
            ∀a. (∀b x. P a b x) ⟷ (∀b y. P' a b y)
is a valid application.*)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>bind_thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>bind_thms_same_name</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>y</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
   </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span>apfst</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span>::</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_forall_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>HOL.All</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ty</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span>  </span><span class="entity"><span>ty</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_forall_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_forall_quantified_names_q</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>HOL.All</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>name</span></span><span> </span><span>::</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="entity"><span>u</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>extract_quantified_names_ba</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span>
  </span><span>#&gt;</span><span> </span><span class="entity"><span>extract_quantified_names_q</span></span><span>
  </span><span>##&gt;</span><span> </span><span class="entity"><span>HOLogic.dest_eq</span></span><span>
  </span><span>##&gt;</span><span> </span><span>fst</span><span>
  </span><span>##&gt;</span><span> </span><span class="entity"><span>extract_quantified_names_q</span></span><span>
  </span><span>##&gt;</span><span> </span><span>fst</span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>extract_quantified_names</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>extract_quantified_names_ba</span></span><span>
  </span><span>#&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span>@</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>extract_all_forall_quantified_names</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span>
  </span><span>#&gt;</span><span> </span><span class="entity"><span>HOLogic.dest_eq</span></span><span>
  </span><span>#&gt;</span><span> </span><span>fst</span><span>
  </span><span>#&gt;</span><span> </span><span class="entity"><span>extract_all_forall_quantified_names_q</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>HOL.Ex</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>name</span></span><span> </span><span>::</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>u</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>extract_all_exists_quantified_names</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span>
  </span><span>#&gt;</span><span> </span><span class="entity"><span>HOLogic.dest_eq</span></span><span>
  </span><span>#&gt;</span><span> </span><span>fst</span><span>
  </span><span>#&gt;</span><span> </span><span class="entity"><span>extract_all_exists_quantified_names_q</span></span><span>


</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>HOL.Ex</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>name</span></span><span> </span><span>::</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>HOL.All</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>name</span></span><span> </span><span>::</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="entity"><span>u</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>extract_bind_names</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span class="entity"><span>HOLogic.dest_eq</span></span><span>
   </span><span>#&gt;</span><span> </span><span>apply2</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>(</span></span><span>Free</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>n1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>n2</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>bounds</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>n1'</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>formula</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>n1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>n1'</span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>n1</span></span><span> </span><span>&lt;&gt;</span><span> </span><span class="entity"><span>n2</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
         </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>bind_thms</span></span><span>
         </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
         </span><span>THEN'</span><span> </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>bounds</span></span><span> </span><span class="entity"><span>formula</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>bind_thms_same_name</span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>bounds</span></span><span> </span><span class="entity"><span>formula</span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.allI|fact"><span>allI</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>n1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>n2</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>bounds</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>formula</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>K</span><span> </span><span>all_tac</span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>bind_quants</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>combine_quant</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="entity"><span>extract_bind_names</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_quantified_names</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>generalize_prems_q</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prems</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>generalize_prems_q</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>quants</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>generalize_prems_q</span></span><span> </span><span class="entity"><span>quants</span></span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.spec|fact"><span>spec</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prems</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>generalize_prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>generalize_prems_q</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>extract_quantified_names_ba</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>bind</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prems</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="entity"><span>bind_quants</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>generalize_prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>prems</span></span><span class="main"><span>]</span></span><span>
      </span><span>THEN_ALL_NEW</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>ORELSE'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
 </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>bind</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid bind application"</span></span><span> </span><span class="entity"><span>Bind</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>


</span><span class="comment1"><span>(* Congruence/Refl *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>cong</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>try_provers</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>string_of_verit_rule</span></span><span> </span><span class="entity"><span>Cong</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span>
  </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"basic"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.cong_basic</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"unfolding then reflexivity"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.cong_unfolding_trivial</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"unfolding then auto"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.cong_unfolding_first</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"full"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.cong_full</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>thms</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>refl</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>find_first</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.full_prop_of</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
      </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>thm</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>try</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>cong</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>t</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* Instantiation *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>dropWhile</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>dropWhile</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>dropWhile</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>xs</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>forall_inst</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>insts</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>instantiate_and_solve</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span>context </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span> prems </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prem</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Subgoal.focus</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.prop_of</span><span> </span><span class="entity"><span>prem</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>quants</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>t</span></span><span>
            </span><span>|&gt;</span><span> </span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span>
            </span><span>|&gt;</span><span> </span><span class="entity"><span>extract_forall_quantified_names_q</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>insts</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>Symtab.lookup</span><span> </span><span class="entity"><span>insts</span></span><span> </span><span>o</span><span> </span><span>fst</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>rev</span><span> </span><span class="entity"><span>quants</span></span><span class="main"><span>)</span></span><span>
            </span><span>|&gt;</span><span> </span><span class="entity"><span>dropWhile</span></span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span>
            </span><span>|&gt;</span><span> </span><span>rev</span><span>
          </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>option_map</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=</span></span><span> </span><span>NONE</span><span>
            </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>option_map</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>instantiate_with</span></span><span> </span><span class="entity"><span>inst</span></span><span> </span><span class="entity"><span>prem</span></span><span> </span><span class="main"><span>=</span></span><span>
            </span><span>Drule.infer_instantiate'</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span>NONE</span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>inst</span></span><span class="main"><span>]</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.spec|fact"><span>spec</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prem</span></span><span class="main"><span>]</span></span><span>
          </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>inst_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
            </span><span>fold</span><span> </span><span class="entity"><span>instantiate_with</span></span><span>
              </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>option_map</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>insts</span></span><span class="main"><span>)</span></span><span>
              </span><span class="entity"><span>prem</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
           </span><span class="main"><span>(</span></span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>inst_thm</span></span><span class="main"><span>]</span></span><span>
           </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span>
           </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span> </span><a class="entity_ref" href="../../../../../Groups.html#Groups.ac_simps|fact"><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
           </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>blast_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>i</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
     </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>instantiate_and_solve</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span>context </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span> prems </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Subgoal.focus</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
         </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application"</span></span><span> </span><span class="entity"><span>Forall_Inst</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_not1|fact"><span>disj_not1</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
      </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Subgoal.FOCUS</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>instantiate_and_solve</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Or *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>or</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>thm</span></span><span> </span><span>::</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>thm</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>or</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid bind application"</span></span><span> </span><span class="entity"><span>Or</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>


</span><span class="comment1"><span>(* Implication *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_pos_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>implies_pos</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>implies_pos_thm</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* Skolemization *)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>split</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>split</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>a</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="entity"><span>split</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>xs</span></span><span>
        </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>a</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>apfst</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span>::</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span>apsnd</span><span> </span><span class="main"><span>(</span></span><span>curry</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span>::</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_rewrite_rule_assumption</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_rewrite_rule</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.prop_of</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span>›</span></span></span><span> </span><span>$</span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span> </span><span>$</span><span> </span><span>Free</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>true</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_context_rule</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.prop_of</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span>›</span></span></span><span> </span><span>$</span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Free</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Free</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>true</span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>false</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ctxt_eq</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>thms</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>split</span></span><span> </span><span class="entity"><span>is_context_rule</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rew</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>other</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>split</span></span><span> </span><span class="entity"><span>is_rewrite_rule</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>ctxt_eq</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>rew</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="comment1"><span>(*
Without compression, we have to rewrite skolems only once. However, it can happen than the same
skolem constant is used multiple times with a different name under the forall.

For strictness, we use the multiple rewriting only when compressing is activated.
*)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="entity"><span>thm_indirect</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
       </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>rewrite_sk_thms</span></span><span> </span><span class="main"><span>=</span></span><span>
         </span><span>List.mapPartial</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>tm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tm</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword3"><span class="keyword"><span>handle</span></span></span><span> </span><span>THM</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thm_indirect</span></span><span>
       </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>multiple_rew</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>SMT_Config.compress_verit_proofs</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>REPEAT_CHANGED</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>x</span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
       </span><span class="entity"><span>multiple_rew</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>EqSubst.eqsubst_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="inner_numeral"><span>0</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>rewrite_sk_thms</span></span><span>
         </span><span>THEN'</span><span> </span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span>HEADGOAL</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
       </span><span>THEN'</span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="entity"><span>thm_indirect</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
   </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="entity"><span>thm_indirect</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span>NONE</span><span class="main"><span>)</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="entity"><span>thm_indirect</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span>
   </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span>all_tac</span><span class="main"><span>)</span></span><span>

   </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>extract_var_name</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>thm</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.concl_of</span><span> </span><span class="entity"><span>thm</span></span><span>
         </span><span>|&gt;</span><span> </span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span>
         </span><span>|&gt;</span><span> </span><span class="entity"><span>HOLogic.dest_eq</span></span><span>
         </span><span>|&gt;</span><span> </span><span>fst</span><span>
         </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span>Const</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span>Abs</span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span class="main"><span>,</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.sym|fact"><span>sym</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>
             </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>extract_var_name</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>extract_var_name</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>skolem_tac</span></span><span> </span><span class="entity"><span>extractor</span></span><span> </span><span class="entity"><span>thm1</span></span><span> </span><span class="entity"><span>thm2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>  </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ctxt_eq</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>ts</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>other</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>extract_rewrite_rule_assumption</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ordered_definitions</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>var_order</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>extractor</span></span><span> </span><span class="entity"><span>t</span></span><span>
        </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm_names_with_var</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>extract_var_name</span></span><span> </span><span class="entity"><span>ts</span></span><span> </span><span>|&gt;</span><span> </span><span>flat</span><span>
      </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>v</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thm_names_with_var</span></span><span> </span><span class="entity"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>var_order</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ctxt_eq</span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>rewrite_all_skolems</span></span><span> </span><span class="entity"><span>thm2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>ordered_definitions</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eqsubst_all</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span>RS</span><span> </span><span class="entity"><span>sym</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>other</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN_ALL_NEW</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ctxt_eq</span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>skolem_forall</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>skolem_tac</span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_forall_indirect|fact"><span>verit_sko_forall_indirect</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_forall_indirect2|fact"><span>verit_sko_forall_indirect2</span></a><span>  </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_ex_indirect2|fact"><span>verit_sko_ex_indirect2</span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>skolem_ex</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>skolem_tac</span></span><span> </span><span class="entity"><span>extract_all_forall_exists_quantified_names_q</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_ex_indirect|fact"><span>verit_sko_ex_indirect</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_ex_indirect2|fact"><span>verit_sko_ex_indirect2</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sko_forall_indirect2|fact"><span>verit_sko_forall_indirect2</span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq_reflexive</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>not_not_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_simplify_1|fact"><span>verit_or_simplify_1</span></a><span class="antiquote"><span>}</span></span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>duplicate_literals_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
    </span><span>THEN'</span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span>TRY</span><span> </span><span>o</span><span> </span><span>CHANGED_PROP</span><span> </span><span>o</span><span> </span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span>CHANGED_PROP</span><span> </span><span>o</span><span> </span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disjE|fact"><span>disjE</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.notE|fact"><span>notE</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>tautological_clause_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_neg|fact"><span>verit_or_neg</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_assoc|fact"><span>disj_assoc</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.notE|fact"><span>notE</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN_ALL_NEW</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>theory_resolution2_lemma</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>abstracter</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>Conv.fconv_rule</span><span> </span><span>Thm.eta_long_conversion</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thms</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.eta_long_conversion</span><span> </span><span class="main"><span>(</span></span><span>Object_Logic.dest_judgment</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.dest_equals</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>t'</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>SMT_Replay_Methods.prove_abstract</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t2</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="main"><span>(</span></span><span>
        </span><span>fold_map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>abstracter</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>SMT_Replay_Methods.dest_thm</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span>##&gt;&gt;</span><span>
        </span><span class="entity"><span>abstracter</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>SMT_Replay_Methods.dest_prop</span></span><span> </span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_Pure_trans|fact"><span>verit_Pure_trans</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>t'</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_not</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_bool_shallow</span></span><span> </span><span class="entity"><span>not_not_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>tautological_clause</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_bool_shallow</span></span><span> </span><span class="entity"><span>tautological_clause_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>duplicate_literals</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_bool_shallow</span></span><span> </span><span class="entity"><span>duplicate_literals_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>unit_res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_bool_shallow</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prop_tac</span></span><span>

</span><span class="comment1"><span>(*match_instantiate does not work*)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>theory_resolution2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>theory_resolution2_lemma</span></span><span> </span><span>OF</span><span> </span><span class="entity"><span>prems</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>normalized_input</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.trigger_def|fact"><span>SMT.trigger_def</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>false_rule_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="../../../../../HOL.html#HOL.False|const"><span>False</span></a><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>false_rule</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>false_rule_thm</span></span><span>


</span><span class="comment1"><span>(* Transitivity *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_bool_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>trans</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>prop_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>HOLogic.dest_Trueprop</span></span><span> </span><span>o</span><span> </span><span>Thm.full_prop_of</span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>combine_thms</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm2</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>prop_of</span></span><span> </span><span class="entity"><span>thm1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>prop_of</span></span><span> </span><span class="entity"><span>thm2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
            </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
             </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t3</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>t2</span></span><span> </span><span>aconv</span><span> </span><span class="entity"><span>t3</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>thm1</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm2</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.trans|fact"><span>trans</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>t2</span></span><span> </span><span>aconv</span><span> </span><span class="entity"><span>t4</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>thm1</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>thm2</span></span><span> </span><span>RS</span><span> </span><span class="entity"><span>sym</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.trans|fact"><span>trans</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>aconv</span><span> </span><span class="entity"><span>t4</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>thm2</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm1</span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.trans|fact"><span>trans</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>Fail</span><span> </span><span class="inner_quoted"><span>"invalid trans theorem"</span></span><span>
          </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>trans_bool_thm</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm2</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>combine_thms</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>thm1</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thm2</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="entity"><span>combine_thms</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>combine_thms</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>thm2</span></span><span class="main"><span>]</span></span><span> </span><span>::</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>combine_thms</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid bind application"</span></span><span> </span><span class="entity"><span>Trans</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>
     </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>t'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Thm.eta_long_conversion</span><span> </span><span class="main"><span>(</span></span><span>Object_Logic.dest_judgment</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Logic.dest_equals</span><span> </span><span class="main"><span>(</span></span><span>Thm.prop_of</span><span> </span><span class="entity"><span>t'</span></span><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>Conv.fconv_rule</span><span> </span><span>Thm.eta_long_conversion</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thms</span></span><span>
     </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>trans_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>combine_thms</span></span><span> </span><span class="entity"><span>thms</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
     </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>prop_of</span></span><span> </span><span class="entity"><span>trans_thm</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
       </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
             </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>HOL.eq</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t3</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
       </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>aconv</span><span> </span><span class="entity"><span>t3</span></span><span> </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="entity"><span>trans_thm</span></span><span> </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>trans_thm</span></span><span> </span><span>RS</span><span> </span><span class="entity"><span>sym</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>trans_thm</span></span><span> </span><span class="comment1"><span>(*to be on the safe side*)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>tmp_AC_rule</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span>
    </span><span>THEN'</span><span> </span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../Groups.html#Groups.ac_simps|fact"><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conj_ac|fact"><span>conj_ac</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Classical.fast_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>


</span><span class="comment1"><span>(* And/Or *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>not_and_rule_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
     </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_conj|fact"><span>de_Morgan_conj</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN_ALL_NEW</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>or_pos_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN'</span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_pos|fact"><span>verit_and_pos</span></a><span class="antiquote"><span>}</span></span></span></span><span>
     </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_conj|fact"><span>de_Morgan_conj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>not_or_rule_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
     </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
       </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>and_rule_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
     </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>REPEAT</span><span> </span><span class="main"><span>(</span></span><span>dresolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span>THEN</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span>+</span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>and_neg_rule_prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_neg|fact"><span>verit_and_neg</span></a><span class="antiquote"><span>}</span></span></span></span><span>
     </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_conj|fact"><span>de_Morgan_conj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
     </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>tac</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_prop</span></span><span> </span><span class="entity"><span>tac</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>and_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>and_rule_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_and_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>not_and_rule_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_or_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>not_or_rule_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>or_pos_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>or_pos_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>and_neg_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prover</span></span><span> </span><span class="entity"><span>and_neg_rule_prove</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>or_neg_rule</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_bool</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_neg|fact"><span>verit_or_neg</span></a><span class="antiquote"><span>}</span></span></span></span><span>
  </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN_ALL_NEW</span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT'</span></span><span>
      </span><span class="main"><span>(</span></span><span>SOLVED'</span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disjI1|fact"><span>disjI1</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN_ALL_NEW</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
       </span><span>ORELSE'</span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disjI2|fact"><span>disjI2</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>and_pos</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>REPEAT_CHANGED</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_pos|fact"><span>verit_and_pos</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Equivalence Transformation *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="entity"><span>equiv_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>equiv_thm</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
        </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application in some equiv rule"</span></span><span> </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_equiv1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_equiv2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv1</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_implies1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>A</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_implies2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Equivalence Lemma *)</span></span><span>
</span><span class="comment1"><span>(*equiv_pos2 is very important for performance. We have tried various tactics, including
a specialisation of SMT_Replay_Methods.match_instantiate, but there never was a measurable
and consistent gain.*)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_equiv_pos_neg2</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>thm</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_pos1_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_pos1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv_pos_neg2</span></span><span> </span><span class="entity"><span>equiv_pos1_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_pos2_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>⋀</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_pos2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv_pos_neg2</span></span><span> </span><span class="entity"><span>equiv_pos2_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_neg1_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_neg1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv_pos_neg2</span></span><span> </span><span class="entity"><span>equiv_neg1_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_neg2_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>equiv_neg2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_equiv_pos_neg2</span></span><span> </span><span class="entity"><span>equiv_neg2_thm</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>implies_pos_neg_term</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Trueprop|const"><span>Trueprop</span></a><span>›</span></span></span><span> </span><span>$</span><span>
         </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>HOL.disj</span></a><span>›</span></span></span><span> </span><span>$</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>HOL.implies</span></a><span>›</span></span></span><span> </span><span>$</span><span> </span><span class="entity"><span>a</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
         </span><span>Drule.infer_instantiate'</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span>o</span><span> </span><span>Thm.cterm_of</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>thm</span></span><span>
     </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>implies_pos_neg_term</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span>  </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application in Implies"</span></span><span> </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_implies_pos_neg</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>implies_pos_neg_term</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>t</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span>
        </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_neg1_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>a</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_neg1</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_implies_pos_neg</span></span><span> </span><span class="entity"><span>implies_neg1_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_neg2_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_neg2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_implies_pos_neg</span></span><span> </span><span class="entity"><span>implies_neg2_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>implies_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>b</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>implies_rules</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>implies_thm</span></span><span> </span><span>OF</span><span> </span><span class="entity"><span>prems</span></span><span class="main"><span>]</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* BFun *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>bfun_theorems</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_bfun_elim|fact"><span>verit_bfun_elim</span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>bfun_elim</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eqsubst_all</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>bfun_theorems</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.all_conj_distrib|fact"><span>all_conj_distrib</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.ex_disj_distrib|fact"><span>ex_disj_distrib</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* If-Then-Else *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_ite</span></span><span> </span><span class="entity"><span>ite_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>ite_thm</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite_pos1_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>Q</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite_pos1</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>ite_pos1_thm</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite_pos2_thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite_pos2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ite_pos2_thms</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite_neg1_thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>Q</span></span><span>›</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>Q</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite_neg1</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ite_neg1_thms</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite_neg2_thms</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span>›</span></span><span>
          </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span>
      </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite_neg2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ite_neg2_thms</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite1_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>Q</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span> </span><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite1</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>prove_ite</span></span><span> </span><span class="entity"><span>ite1_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ite2_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span> </span><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>prove_ite</span></span><span> </span><span class="entity"><span>ite2_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_ite1_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>Q</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span> </span><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>not_ite1</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>prove_ite</span></span><span> </span><span class="entity"><span>not_ite1_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_ite2_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../../../../HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_splits|fact"><span>if_splits</span></a><span class="main"><span>)</span></span><span> </span><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>not_ite2</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>prove_ite</span></span><span> </span><span class="entity"><span>not_ite2_thm</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(*ite_intro can introduce new terms that are in the proof exactly the sames as the old one, but are
not internally, hence the possible reordering.*)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>ite_intro</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>simplify_ite</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>ctxt</span></span><span>
      </span><span>|&gt;</span><span> </span><span>empty_simpset</span><span>
      </span><span>|&gt;</span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span>
      </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>addsimps</span><span> </span><span class="entity"><span>thms</span></span><span> </span><span>@</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_True|fact"><span>if_True</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_False|fact"><span>if_False</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.simp_thms|fact"><span>simp_thms</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_cancel|fact"><span>if_cancel</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>|&gt;</span><span> </span><span>Raw_Simplifier.add_eqcong</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_ite_if_cong|fact"><span>verit_ite_if_cong</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span>|&gt;</span><span> </span><span class="entity"><span>Simplifier.full_simp_tac</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>simplify_ite</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>
       </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>simplify_ite</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_commute|fact"><span>eq_commute</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Quantifiers *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>rm_unused</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>P</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span class="keyword3"><span>+</span></span></span><span class="antiquote"><span>}</span></span></span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>qnt_cnf_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_conj|fact"><span>de_Morgan_conj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.imp_conv_disj|fact"><span>imp_conv_disj</span></a><span>
      </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iff_conv_conj_imp|fact"><span>iff_conv_conj_imp</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.if_bool_eq_disj|fact"><span>if_bool_eq_disj</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.ex_simps|fact"><span>ex_simps</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.all_simps|fact"><span>all_simps</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.ex_disj_distrib|fact"><span>ex_disj_distrib</span></a><span>
      </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_connective_def|fact"><span>verit_connective_def</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.all_conj_distrib|fact"><span>all_conj_distrib</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Blast.blast_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>qnt_rm_unused</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>rm_unused</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>onepoint</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>Simplifier.full_simp_tac</span></span><span> </span><span class="main"><span>(</span></span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span> </span><span class="main"><span>(</span></span><span>empty_simpset</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
    </span><span>addsimps</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.simp_thms|fact"><span>HOL.simp_thms</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.all_simps|fact"><span>HOL.all_simps</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>addsimprocs</span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>simproc</span></span><span> </span><span>HOL.defined_All</span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>simproc</span></span><span> </span><span>HOL.defined_Ex</span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Blast.blast_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Metis_Tactic.metis_tac</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>ATP_Problem_Generate.combsN</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>qnt_join</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>Classical.fast_tac</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>qnt_cnf</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>qnt_cnf_tac</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>qnt_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="comment1"><span>(* Equality *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq_transitive</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span>  </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
  </span><span class="entity"><span>REPEAT_CHANGED</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_not1|fact"><span>disj_not1</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>OF</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>eresolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>dresolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_eq_transitive|fact"><span>verit_eq_transitive</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span>THEN</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>i</span></span><span>+</span><span class="inner_numeral"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span>THEN'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>find_rew</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>t'</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
      </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>thm</span></span><span> </span><span>COMP</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><span>symmetric</span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>AList.lookup</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>op</span></span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t'</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>NONE</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq_pred_conv</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ctrm</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>find_rew</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span>Thm.term_of</span><span> </span><span class="entity"><span>ctrm</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
      </span><span>SOME</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Conv.rewr_conv</span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="entity"><span>ctrm</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
        </span><span class="entity"><span>f</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>arg</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span class="main"><span>(</span></span><span>Conv.fun_conv</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eq_pred_conv</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span>then_conv</span><span>
             </span><span>Conv.arg_conv</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eq_pred_conv</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>arg</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctrm</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span>Abs</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Conv.abs_conv</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eq_pred_conv</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>f</span></span><span> </span><span>o</span><span> </span><span>snd</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>ctrm</span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Conv.all_conv</span><span> </span><span class="entity"><span>ctrm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq_pred_rewrite_tac</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span>context </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>prems</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>...</span></span><span class="main"><span>}</span></span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Subgoal.focus</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prems</span></span><span>
       </span><span>|&gt;</span><span> </span><span>map_filter</span><span> </span><span class="main"><span>(</span></span><span>try</span><span> </span><span class="main"><span>(</span></span><span>apfst</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>HOLogic.dest_eq</span></span><span> </span><span>o</span><span> </span><span>Thm.term_of</span><span> </span><span>o</span><span> </span><span>Object_Logic.dest_judgment</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>o</span><span>
            </span><span>Thm.cconcl_of</span><span class="main"><span>)</span></span><span> </span><span>o</span><span> </span><span>`</span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
       </span><span>|&gt;</span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span>apsnd</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>x</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_reflection|fact"><span>eq_reflection</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>conv_left</span></span><span> </span><span class="entity"><span>conv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Conv.arg_conv</span><span> </span><span class="main"><span>(</span></span><span>Conv.arg_conv</span><span> </span><span class="entity"><span>conv</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>conv_left_neg</span></span><span> </span><span class="entity"><span>conv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Conv.arg_conv</span><span> </span><span class="main"><span>(</span></span><span>Conv.arg_conv</span><span> </span><span class="main"><span>(</span></span><span>Conv.arg_conv</span><span> </span><span class="entity"><span>conv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>conv_term</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Thm.term_of</span><span> </span><span class="main"><span>(</span></span><span>Object_Logic.dest_judgment</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>concl</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span>
          </span><span>Const</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>HOL.Not</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t1</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>conv_left</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span>Const</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>$</span><span> </span><span class="main"><span>(</span></span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>HOL.Not</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>conv_left_neg</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span>Const</span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>t1</span></span><span> </span><span>$</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>conv_left</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>t1</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>t1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>conv_left</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>throwing_CONVERSION</span></span><span> </span><span class="entity"><span>cv</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Seq.single</span><span> </span><span class="main"><span>(</span></span><span>Conv.gconv_rule</span><span> </span><span class="entity"><span>cv</span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="entity"><span>st</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
      </span><span class="entity"><span>throwing_CONVERSION</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>conv_term</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>eq_pred_conv</span></span><span> </span><span class="entity"><span>rews</span></span><span> </span><span class="entity"><span>t1</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>eq_congruent_pred</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
   </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_not1|fact"><span>disj_not1</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>_</span></span><span>›</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>OF</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
   </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>i</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Subgoal.FOCUS</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>focus</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>eq_pred_rewrite_tac</span></span><span> </span><span class="entity"><span>focus</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>i</span></span><span class="main"><span>)</span></span><span>
   </span><span>THEN'</span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.refl|fact"><span>refl</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.excluded_middle|fact"><span>excluded_middle</span></a><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.excluded_middle|fact"><span>excluded_middle</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>_</span></span><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span>
     </span><span>ORELSE'</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>eq_congruent</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>eq_congruent_pred</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Subproof *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>subproof</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prem</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_not1|fact"><span>disj_not1</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span>
           </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disj_not1|fact"><span>disj_not1</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>_</span></span><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span> </span><span>RSN</span><span> </span><span class="main"><span>(</span></span><span class="inner_numeral"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.iffD2|fact"><span>iffD2</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.impI|fact"><span>impI</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>
        </span><span>THEN'</span><span> </span><span>resolve_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prem</span></span><span class="main"><span>]</span></span><span>
        </span><span>THEN_ALL_NEW</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span>ORELSE'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>prem</span></span><span class="main"><span>]</span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>Blast.blast_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>subproof</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application, only one assumption expected"</span></span><span> </span><span class="entity"><span>Subproof</span></span><span> </span><span class="entity"><span>prems</span></span><span> </span><span class="entity"><span>t</span></span><span>


</span><span class="comment1"><span>(* Simplifying Steps *)</span></span><span>

</span><span class="comment1"><span>(* The reconstruction is a bit tricky: At first we only rewrite only based on the rules that are
passed as argument. Then we simply use simp_thms to reconstruct all the proofs (and these theorems
cover all the simplification below).
*)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_only_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>ctxt</span></span><span>
    </span><span>|&gt;</span><span> </span><span>empty_simpset</span><span>
    </span><span>|&gt;</span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span>
    </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>addsimps</span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
    </span><span>|&gt;</span><span> </span><span class="entity"><span>Simplifier.full_simp_tac</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_only_thms_tmp</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>rewrite_only_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>ctxt</span></span><span>
    </span><span>|&gt;</span><span> </span><span>empty_simpset</span><span>
    </span><span>|&gt;</span><span> </span><span>put_simpset</span><span> </span><span class="entity"><span>HOL_basic_ss</span></span><span>
    </span><span>|&gt;</span><span> </span><span>Raw_Simplifier.add_eqcong</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.eq_reflection|fact"><span>eq_reflection</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.imp_cong|fact"><span>imp_cong</span></a><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>|&gt;</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span>addsimps</span><span> </span><span class="entity"><span>thms</span></span><span> </span><span>addsimps</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.simp_thms|fact"><span>simp_thms</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>|&gt;</span><span> </span><span class="entity"><span>Simplifier.full_simp_tac</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>chain_rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms1</span></span><span> </span><span class="entity"><span>thms2</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms1</span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms2</span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>chain_rewrite_thms_two_step</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms1</span></span><span> </span><span class="entity"><span>thms2</span></span><span> </span><span class="entity"><span>thms3</span></span><span> </span><span class="entity"><span>thms4</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms1</span></span><span> </span><span class="entity"><span>thms2</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms3</span></span><span> </span><span class="entity"><span>thms4</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>imp_refl</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.True|const"><span>True</span></a><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_bool_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>chain_rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_bool_simplify|fact"><span>verit_bool_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_and_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_simplify|fact"><span>verit_and_simplify</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_simplify1|fact"><span>verit_and_simplify1</span></a><span class="antiquote"><span>}</span></span></span></span><span>
     </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_simplify|fact"><span>verit_and_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_or_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_simplify|fact"><span>verit_or_simplify</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_simplify_1|fact"><span>verit_or_simplify_1</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_or_simplify|fact"><span>verit_or_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>REPEAT'</span></span><span> </span><span class="main"><span>(</span></span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_and_pos|fact"><span>verit_and_pos</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span> </span><span>THEN'</span><span> </span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_not_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms_tmp</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_not_simplify|fact"><span>verit_not_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_equiv_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms_tmp</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_equiv_simplify|fact"><span>verit_equiv_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_eq_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
      </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_eq_simplify|fact"><span>verit_eq_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>Named_Theorems.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>named_theorems</span></span><span> ac_simps</span><span class="antiquote"><span>}</span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_implies_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms_tmp</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_implies_simplify|fact"><span>verit_implies_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* It is more efficient to first fold the implication symbols.
   That is however not enough when symbols appears within
   expressions, hence we also unfold implications in the
   other direction. *)</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_connective_def</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>chain_rewrite_thms_two_step</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>imp_refl</span></span><span> </span><span>::</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_connective_def|fact"><span>verit_connective_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_connective_def|fact"><span>verit_connective_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="entity"><span>imp_refl</span></span><span> </span><span>::</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.not_not|fact"><span>not_not</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_connective_def|fact"><span>verit_connective_def</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_connective_def|fact"><span>verit_connective_def</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_minus_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
      </span><span class="entity"><span>chain_rewrite_two_step_with_ac_simps</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
         </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.arith_simps|fact"><span>arith_simps</span></a><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_minus_simplify|fact"><span>verit_minus_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span>
         </span><span class="main"><span>(</span></span><span class="entity"><span>Named_Theorems.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>named_theorems</span></span><span> ac_simps</span><span class="antiquote"><span>}</span></span></span><span> </span><span>@</span><span>
          </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.numerals|fact"><span>numerals</span></a><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.arith_simps|fact"><span>arith_simps</span></a><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.arith_special|fact"><span>arith_special</span></a><span>
             </span><a class="entity_ref" href="../../../../../Num.html#Num.numeral_class.numeral.numeral_One|fact"><span>numeral_class.numeral.numeral_One</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_comp_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>chain_rewrite_thms</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_comp_simplify|fact"><span>verit_comp_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>rewrite_ite_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
   </span><span class="main"><span>(</span></span><span class="entity"><span>rewrite_only_thms_tmp</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_ite_simplify|fact"><span>verit_ite_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Simplifications *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>simplify_arith</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>partial_simplify_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>thms</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>Named_Theorems.get</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>named_theorems</span></span><span> ac_simps</span><span class="antiquote"><span>}</span></span></span><span> </span><span>@</span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.arith_simps|fact"><span>arith_simps</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>sum_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="entity"><span>simplify_arith</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_sum_simplify|fact"><span>verit_sum_simplify</span></a><span> </span><a class="entity_ref" href="../../../../../Num.html#Num.arith_special|fact"><span>arith_special</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prod_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="entity"><span>simplify_arith</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_prod_simplify|fact"><span>verit_prod_simplify</span></a><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>all_simplify</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
     </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Clasimp.auto_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(*TODO: TEMP until cvc5 produces fine grained simplification steps *)</span></span><span>

</span><span class="comment1"><span>(* Arithmetics *)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>la_rw_eq_thm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><a class="entity_ref" href="../../../../../Nat.html#Nat.nat|type"><span>nat</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="antiquote"><span>}</span></span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>la_rw_eq</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="entity"><span>la_rw_eq_thm</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>la_generic_prove</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Arith.la_farkas</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>la_generic</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>args</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>prove_abstract</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>SMT_Replay_Methods.abstract_arith_shallow</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>la_generic_prove</span></span><span> </span><span class="entity"><span>args</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>lia_generic</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.prove_arith_rewrite</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.abstract_neq</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>la_disequality</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>SMT_Replay_Methods.match_instantiate</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../../../../../SMT.html#SMT.verit_la_disequality|fact"><span>verit_la_disequality</span></a><span class="antiquote"><span>}</span></span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="comment1"><span>(* Symm and Not_Symm*)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_symm</span></span><span> </span><span class="entity"><span>symm_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>symm_thm</span></span><span> </span><span>OF</span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
        </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>prove_symm</span></span><span> </span><span class="main"><span>_</span></span><span>  </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application in some symm rule"</span></span><span> </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>symm_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="free"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>B</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="antiquote"><span>}</span></span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>symm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_symm</span></span><span> </span><span class="entity"><span>symm_thm</span></span><span>

  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_symm_thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>lemma</span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../../../../HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span>›</span></span><span> </span><span class="quasi_keyword"><span>by</span></span><span> </span><a class="entity_ref" href="../../../Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> </span><span class="antiquote"><span>}</span></span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>not_symm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_symm</span></span><span> </span><span class="entity"><span>not_symm_thm</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="comment1"><span>(* Reordering *)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>local</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>prove_reordering</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>SMT_Replay_Methods.prove</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span class="main"><span>(</span></span><span>
      </span><span class="entity"><span>Method.insert_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span>
      </span><span>THEN'</span><span> </span><span>match_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="antiquote"><span>}</span></span></span></span><span>
      </span><span>THEN'</span><span> </span><span>K</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>unfold_tac</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.de_Morgan_disj|fact"><span>de_Morgan_disj</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span>TRY</span><span> </span><span>o</span><span> </span><span>CHANGED_PROP</span><span> </span><span>o</span><span> </span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span>CHANGED_PROP</span><span> </span><span>o</span><span> </span><span>REPEAT_ALL_NEW</span><span> </span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.disjE|fact"><span>disjE</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span>THEN'</span><span> </span><span class="entity"><span>REPEAT'</span></span><span class="main"><span>(</span></span><span>ematch_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thms</span></span><span> </span><a class="entity_ref" href="../../../../../HOL.html#HOL.notE|fact"><span>notE</span></a><span class="antiquote"><span>}</span></span></span></span><span> </span><span>THEN'</span><span> </span><span class="entity"><span>TRY'</span></span><span> </span><span class="main"><span>(</span></span><span>assume_tac</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>prove_reordering</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="entity"><span>replay_error</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="inner_quoted"><span>"invalid application in some reordering rule"</span></span><span> </span><span class="entity"><span>Unsupported</span></span><span> </span><span class="entity"><span>thms</span></span><span> </span><span class="entity"><span>t</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>reordering</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>prove_reordering</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span class="main"><span>;</span></span><span>
</span></pre>
</body>

</html>